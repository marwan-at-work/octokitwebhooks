{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "common/alert-instance.schema.json",
  "type": [
    "object",
    "null"
  ],
  "properties": {
    "analysis_key": {
      "type": "string",
      "description": "Identifies the configuration under which the analysis was executed. For example, in GitHub Actions this includes the workflow filename and job name."
    },
    "classifications": {
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "commit_sha": {
      "type": "string"
    },
    "environment": {
      "type": "string",
      "description": "Identifies the variable values associated with the environment in which the analysis that generated this alert instance was performed, such as the language that was analyzed."
    },
    "location": {
      "type": "object",
      "properties": {
        "end_column": {
          "type": "integer"
        },
        "end_line": {
          "type": "integer"
        },
        "path": {
          "type": "string"
        },
        "start_column": {
          "type": "integer"
        },
        "start_line": {
          "type": "integer"
        }
      },
      "additionalProperties": false
    },
    "message": {
      "type": "object",
      "properties": {
        "text": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "ref": {
      "type": "string",
      "description": "The full Git reference, formatted as `refs/heads/\u003cbranch name\u003e`."
    },
    "state": {
      "type": "string",
      "enum": [
        "open",
        "dismissed",
        "fixed"
      ],
      "description": "State of a code scanning alert."
    }
  },
  "required": [
    "ref",
    "analysis_key",
    "environment",
    "state"
  ],
  "additionalProperties": false,
  "title": "Alert Instance"
}